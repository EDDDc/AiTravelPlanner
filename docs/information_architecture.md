# 信息架构与导航流程

## 1. 顶层结构

```
根路径 /
├── Dashboard 仪表盘
│   ├── 行程列表（分页、搜索、筛选）
│   └── 最近更新 / 待办事项
├── Plan 行程详情
│   ├── Summary 概览
│   ├── Timeline 时间轴视图
│   ├── Map 地图视图
│   └── Budget 预算中心
├── Create 新建行程向导
├── Settings 设置中心
│   ├── Profile 个人信息
│   ├── ApiKeys API Key 管理
│   └── Notifications 通知偏好
└── Help 帮助 / FAQ（可选）
```

## 2. 导航模式

- **主导航（顶部 + 侧栏）**：顶部显示全局操作（新建行程、搜索、用户菜单），侧栏固定上述模块条目。
- **上下文导航**：在行程详情内部，通过 Tab 切换 `概览 / 时间轴 / 地图 / 预算 / 回顾`。
- **浮层交互**：新建行程采用弹窗/全屏步骤向导；记账、添加活动使用右侧抽屉或对话框。

## 3. 信息流

1. 用户进入仪表盘，选择已有行程或点击“新建行程”。
2. 新建行程向导收集基础信息与偏好 → 写入后端 → 请求 LLM 生成行程 → 返回结构化数据。
3. 行程详情页面从后端获取最新行程数据，分为四个子视图：
   - 概览：显示行程摘要、预算、提醒。
   - 时间轴：结构化日程及编辑能力。
   - 地图：高德 API 绘制路线与 POI。
   - 预算：汇总语音/手动记账。
4. 设置中心负责 Key 与通知配置，一旦保存触发后端校验并安全存储。

## 4. 关键数据对象

- `User`：账户、偏好、API Key 绑定。
- `TravelPlan`：计划基础信息、预算上限。
- `DayPlan`：按天的概述与备注。
- `Activity`：交通/景点/餐饮等活动条目，包含时间、地点、费用估算。
- `Expense`：记账明细，记录来源与分类。
- `Notification`：提醒配置或待办。

字段详见 `docs/domain_dictionary.md`。

## 5. 权限与访问控制

- 未登录用户只能访问登录/注册/帮助页。
- 登录后按用户 ID 过滤数据；后续若有共享计划，可扩展基于角色的访问控制。
- 系统设置页需验证身份后才能访问（可采用前端路由守卫 + 后端鉴权）。

## 6. 路由与状态管理

- 前端路由建议采用以下模式：

  ```
  /login
  /register
  /plans
  /plans/:planId
  /plans/:planId/map
  /plans/:planId/budget
  /settings
  ```

- Pinia store 拆分：
  - `authStore`：用户信息、Token
  - `planStore`：当前行程详情、列表缓存
  - `budgetStore`：预算统计与设置
  - `settingsStore`：API Key 状态、通知配置

## 7. 第三方服务接入点

- **阿里云百炼**：新建行程、编辑行程建议、旅行问答。
- **科大讯飞**：语音转写（新建行程时的语音需求、语音记账）。
- **高德地图**：地图展示、路线规划、POI 查询。
- **Supabase/PostgreSQL**：行程、活动、预算等数据存储。

所有服务调用将通过后端统一封装，前端仅调用自建 API。

---

信息架构变更时，请同步更新此文档和 `development_flow.md` 中的阶段状态，确保所有成员对导航与数据流保持共识。
